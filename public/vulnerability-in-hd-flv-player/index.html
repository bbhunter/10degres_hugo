<!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <meta name="author" content="Gwendal Le Coguic">
    <meta name="description" content="Gwendal Le Coguic, developer and bug hunter">
    <meta name="keywords" content="developer,security,researcher,pentester,bugbounty,bughunter,tools,bash,php,python,golang">

    <meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://10degres.net/assets/img/header-background.jpg"/>

<meta name="twitter:title" content="Vulnerability in HD FLV Player"/>
<meta name="twitter:description" content="Reported by Sucuri,
the HD FLV Player suffers of an Arbitrary File Download vulnerability which is of course considered critical.
The vulnerable code can be found in download.php:
&lt;?php
$filename = $_GET[&#39;f&#39;];
header(&#39;Content-disposition: attachment; filename=&#39;.basename($filename));
readfile($filename);
?&gt;
Since there is absolutly no check nor filter applied before using the f parameter passed in the url, this is the perfect backdoor to get almost any file you want on the machine
(depending of the right of the user the server is running). No matter the plugin is enable or not, you simply need to run the install to be exposed."/>
<meta name="twitter:site" content="@10degres"/>
<meta name="twitter:creator" content="@gwendallecoguic"/>

    <meta property="og:title" content="Vulnerability in HD FLV Player" />
<meta property="og:description" content="Reported by Sucuri,
the HD FLV Player suffers of an Arbitrary File Download vulnerability which is of course considered critical.
The vulnerable code can be found in download.php:
&lt;?php
$filename = $_GET[&#39;f&#39;];
header(&#39;Content-disposition: attachment; filename=&#39;.basename($filename));
readfile($filename);
?&gt;
Since there is absolutly no check nor filter applied before using the f parameter passed in the url, this is the perfect backdoor to get almost any file you want on the machine
(depending of the right of the user the server is running). No matter the plugin is enable or not, you simply need to run the install to be exposed." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://10degres.net/vulnerability-in-hd-flv-player/" />

<meta property="og:image" content="https://10degres.net/assets/img/header-background.jpg" />
<meta property="article:published_time" content="2014-12-15T00:00:00+00:00" />
<meta property="article:modified_time" content="2014-12-15T00:00:00+00:00" /><meta property="og:site_name" content="10degres" />


    
      <base href="https://10degres.net/vulnerability-in-hd-flv-player/">
    
    <title>
  Vulnerability in HD FLV Player · 10degres
</title>

    
      <link rel="canonical" href="https://10degres.net/vulnerability-in-hd-flv-player/">
    

    <link href="https://fonts.googleapis.com/css?family=Lato:400,700%7CMerriweather:300,700%7CSource+Code+Pro:400,700" rel="stylesheet">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.1/css/all.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.1/normalize.min.css" />

    
      
      
      <link rel="stylesheet" href="https://10degres.net/assets/css/coder.min.3d8325016df2bf0f0e874e28c83131f668a953cb3245cf9391fae4ff5b76b2ed.css" integrity="sha256-PYMlAW3yvw8Oh04oyDEx9mipU8syRc&#43;Tkfrk/1t2su0=" crossorigin="anonymous" media="screen" />
    

    

    

    
      <link rel="stylesheet" href="https://10degres.net/assets/css/custom.css" />
    

    <link rel="icon" type="image/png" href="https://10degres.net/assets/img/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="https://10degres.net/assets/img/favicon-16x16.png" sizes="16x16">

    <meta name="generator" content="Hugo 0.102.2" />
  </head>

  <body class=" ">
    <main class="wrapper">
      <nav class="navigation">
  <section class="container">
    <a class="navigation-title" href="https://10degres.net/">
      10degres
    </a>
    <input type="checkbox" id="menu-toggle" />
    <label class="menu-button float-right" for="menu-toggle"><i class="fas fa-bars"></i></label>
    <ul class="navigation-list">
      
        
          <li class="navigation-item">
            <a class="navigation-link" href="https://10degres.net/posts/">Blog</a>
          </li>
        
          <li class="navigation-item">
            <a class="navigation-link" href="https://10degres.net/cves/">CVEs</a>
          </li>
        
          <li class="navigation-item">
            <a class="navigation-link" href="https://10degres.net/services/">Services</a>
          </li>
        
          <li class="navigation-item">
            <a class="navigation-link" href="https://10degres.net/press/">Press</a>
          </li>
        
          <li class="navigation-item">
            <a class="navigation-link" href="https://10degres.net/about/">About</a>
          </li>
        
      
      
    </ul>
  </section>
</nav>


      <div class="content">
        
<section class="container post">

    <div id="share-buttons">
    <a href="http://www.reddit.com/submit?url=http:/&amp;title=Vulnerability%20in%20HD%20FLV%20Player"><img src="https://10degres.net/assets/img/share/reddit.png"></a>
    <a href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2f10degres.net%2fvulnerability-in-hd-flv-player%2f&amp;title=Vulnerability%20in%20HD%20FLV%20Player&amp;summary=&amp;source="><img src="https://10degres.net/assets/img/share/linkedin.png"></a>
    <a href="https://twitter.com/intent/tweet?text=https%3a%2f%2f10degres.net%2fvulnerability-in-hd-flv-player%2f"><img src="https://10degres.net/assets/img/share/twitter.png"></a>
    <a href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2f10degres.net%2fvulnerability-in-hd-flv-player%2f"><img src="https://10degres.net/assets/img/share/facebook.png"></a>
</div>


    <article>
        <header>
            <div class="post-title">
                <h1 class="title">Vulnerability in HD FLV Player</h1>
            </div>
            <div class="post-meta">
                <div class="date">
                    <span class="posted-on">
                      <i class="fas fa-calendar"></i>
                        <time datetime='2014-12-15T00:00:00Z'>
                            December 15, 2014
                        </time>
                    </span>
                    <span class="reading-time">
                        <i class="fas fa-clock"></i>
                        One minute read
                    </span>
                </div>
                
                <div class="tags">
  <i class="fas fa-tag"></i>
    <a href="https://10degres.net/tags/joomla/">joomla</a>
      <span class="separator">•</span>
    <a href="https://10degres.net/tags/file-download/">file download</a>
      <span class="separator">•</span>
    <a href="https://10degres.net/tags/hd-flv-player/">hd flv player</a>
      <span class="separator">•</span>
    <a href="https://10degres.net/tags/wordpress/">wordpress</a></div>

            </div>
          </header>

        <div>
            <p>Reported by <a href="http://blog.sucuri.net/2014/12/critical-vulnerability-in-joomla-hd-flv-player-plugin.html" title="Sucuri">Sucuri</a>,
the HD FLV Player suffers of an Arbitrary File Download vulnerability which is of course considered critical.</p>
<p>The vulnerable code can be found in <code>download.php</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#f92672">&lt;?</span><span style="color:#a6e22e">php</span>
</span></span><span style="display:flex;"><span>$filename <span style="color:#f92672">=</span> $_GET[<span style="color:#e6db74">&#39;f&#39;</span>];
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">header</span>(<span style="color:#e6db74">&#39;Content-disposition: attachment; filename=&#39;</span><span style="color:#f92672">.</span><span style="color:#a6e22e">basename</span>($filename));
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">readfile</span>($filename);
</span></span><span style="display:flex;"><span><span style="color:#75715e">?&gt;</span><span style="color:#960050;background-color:#1e0010">
</span></span></span></code></pre></div><p>Since there is absolutly no check nor filter applied before using the <code>f</code> parameter passed in the url, this is the perfect backdoor to get almost any file you want on the machine
(depending of the right of the user the server is running). No matter the plugin is enable or not, you simply need to run the install to be exposed.</p>
<p>Here is a POC on my local Wordpress (same result might append with Joomla):</p>
<p><img src="https://10degres.net/images/hd_flv_player_wordpress_poc.png" alt="hd flv player wordpress poc"></p>
<p>The wierd thing is that the Wordpress and Joomla plugins have been patched but <strong>not the archive</strong> on
<a href="http://www.hdflvplayer.net/hd-flv-player-download.php" title="HD FLV Player">HD FLV Player official website</a>, leaving custom installations vulnerable.</p>
<p>Note: As Sucuri said, <code>email.php</code> should be considered too but the vulnerability is little more tricky.</p>
        </div>

        <footer>
            


        </footer>
    </article>

    
</section>


      </div>

      <footer class="footer">
  <section class="container">
    
    
    
    
  </section>
</footer>

    </main>

    
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-61485350-1', 'auto');
	
	ga('send', 'pageview');
}
</script>

    
      <script src="https://10degres.net/assets/js/scripts.js"></script>
    

  </body>

</html>
