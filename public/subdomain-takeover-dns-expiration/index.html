<!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <meta name="author" content="Gwendal Le Coguic">
    <meta name="description" content="Gwendal Le Coguic, developer and bug hunter">
    <meta name="keywords" content="developer,security,researcher,pentester,bugbounty,bughunter,tools,bash,php,python,golang">

    <meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://10degres.net/assets/img/header-background.jpg"/>

<meta name="twitter:title" content="Subdomain takeover - DNS expiration"/>
<meta name="twitter:description" content="One quick and easy way to make cash in bug bounty job is subdomain takeover.
The goal is to steal a forgetted/unused subdomain of your target and put a PoC in place.
If you are able to do that, that means that instead of a plain text file, an attacker could replicate the true site of the victim and perform phishing.
This way he could trick users and even the employees of the company to grab useful data like credentials, this can also have really huge impact on the companies reputation.
First of all you have to find a list of subdomains of your target.
To perform that task, you can use a single tool like TheHarvester or DNSRecon."/>
<meta name="twitter:site" content="@Gwendal Le Coguic"/>
<meta name="twitter:creator" content="@gwendallecoguic"/>

    <meta property="og:title" content="Subdomain takeover - DNS expiration" />
<meta property="og:description" content="One quick and easy way to make cash in bug bounty job is subdomain takeover.
The goal is to steal a forgetted/unused subdomain of your target and put a PoC in place.
If you are able to do that, that means that instead of a plain text file, an attacker could replicate the true site of the victim and perform phishing.
This way he could trick users and even the employees of the company to grab useful data like credentials, this can also have really huge impact on the companies reputation.
First of all you have to find a list of subdomains of your target.
To perform that task, you can use a single tool like TheHarvester or DNSRecon." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://10degres.net/subdomain-takeover-dns-expiration/" />

<meta property="og:image" content="https://10degres.net/assets/img/header-background.jpg" />
<meta property="article:published_time" content="2016-10-12T00:00:00+00:00" />
<meta property="article:modified_time" content="2016-10-12T00:00:00+00:00" /><meta property="og:site_name" content="Gwendal Le Coguic" />


    
      <base href="https://10degres.net/subdomain-takeover-dns-expiration/">
    
    <title>
    Subdomain takeover - DNS expiration · Gwendal Le Coguic
</title>

    
      <link rel="canonical" href="https://10degres.net/subdomain-takeover-dns-expiration/">
    

    <link href="https://fonts.googleapis.com/css?family=Lato:400,700%7CMerriweather:300,700%7CSource+Code+Pro:400,700" rel="stylesheet">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.1/css/all.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.1/normalize.min.css" />

    
      
      
      <link rel="stylesheet" href="https://10degres.net/assets/css/coder.min.3d8325016df2bf0f0e874e28c83131f668a953cb3245cf9391fae4ff5b76b2ed.css" integrity="sha256-PYMlAW3yvw8Oh04oyDEx9mipU8syRc&#43;Tkfrk/1t2su0=" crossorigin="anonymous" media="screen" />
    

    

    

    
      <link rel="stylesheet" href="https://10degres.net/assets/css/custom.css" />
    

    <link rel="icon" type="image/png" href="https://10degres.net/images/favicon-256x256.png" sizes="256x256">
    <link rel="icon" type="image/png" href="https://10degres.net/images/favicon-128x128.png" sizes="128x128">
    <link rel="icon" type="image/png" href="https://10degres.net/images/favicon-64x64.png" sizes="64x64">
    <link rel="icon" type="image/png" href="https://10degres.net/assets/img/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="https://10degres.net/assets/img/favicon-16x16.png" sizes="16x16">

    <meta name="generator" content="Hugo 0.102.2" />
  </head>

  <body class=" ">
        <main class="wrapper">
      <nav class="navigation">
  <section class="container">
    <a class="navigation-title" href="https://10degres.net/">
      Gwendal Le Coguic
    </a>
    <input type="checkbox" id="menu-toggle" />
    <label class="menu-button float-right" for="menu-toggle"><i class="fas fa-bars"></i></label>
    <ul class="navigation-list">
      
        
          <li class="navigation-item">
            <a class="navigation-link" href="https://10degres.net/posts/">Blog</a>
          </li>
        
          <li class="navigation-item">
            <a class="navigation-link" href="https://10degres.net/projects/">Projects</a>
          </li>
        
          <li class="navigation-item">
            <a class="navigation-link" href="https://10degres.net/cves/">CVEs</a>
          </li>
        
          <li class="navigation-item">
            <a class="navigation-link" href="https://10degres.net/services/">Services</a>
          </li>
        
          <li class="navigation-item">
            <a class="navigation-link" href="https://10degres.net/press/">Press</a>
          </li>
        
          <li class="navigation-item">
            <a class="navigation-link" href="https://10degres.net/about/">About</a>
          </li>
        
      
      
    </ul>
  </section>
</nav>


      <div class="content">
        
<section class="container post">
    <div id="sharer">
    <div class="sharer-buttons">
        <a href="https://twitter.com/intent/tweet?text=https%3a%2f%2f10degres.net%2fsubdomain-takeover-dns-expiration%2f"><img src="https://10degres.net/assets/img/share/twitter.png"></a>
        <a href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2f10degres.net%2fsubdomain-takeover-dns-expiration%2f&amp;title=Subdomain%20takeover%20-%20DNS%20expiration&amp;summary=&amp;source="><img src="https://10degres.net/assets/img/share/linkedin.png"></a>
        <a href="http://www.reddit.com/submit?url=http:/&amp;title=Subdomain%20takeover%20-%20DNS%20expiration"><img src="https://10degres.net/assets/img/share/reddit.png"></a>
        <a href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2f10degres.net%2fsubdomain-takeover-dns-expiration%2f&amp;t=Subdomain%20takeover%20-%20DNS%20expiration"><img src="https://10degres.net/assets/img/share/ycombinator.png"></a>
        <a href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2f10degres.net%2fsubdomain-takeover-dns-expiration%2f"><img src="https://10degres.net/assets/img/share/facebook.png"></a>
    </div>
</div>


    <article>
        <header>
            <div class="post-title">
                <h1 class="title">Subdomain takeover - DNS expiration</h1>
            </div>
            <div class="post-meta">
                <div class="date">
                    <span class="posted-on">
                        <i class="fas fa-calendar"></i>
                        <time datetime='2016-10-12T00:00:00Z'>
                            October 12, 2016
                        </time>
                    </span>
                    <span class="reading-time">
                        <i class="fas fa-clock"></i>
                        2 minutes read
                    </span>
                </div>
                
                <div class="tags">
  <i class="fas fa-tag"></i>
    <a href="https://10degres.net/tags/dns/">dns</a>
      <span class="separator">•</span>
    <a href="https://10degres.net/tags/subdomain/">subdomain</a>
      <span class="separator">•</span>
    <a href="https://10degres.net/tags/tools/">tools</a>
      <span class="separator">•</span>
    <a href="https://10degres.net/tags/subdomain-takeover/">subdomain takeover</a></div>

            </div>
        </header>

        <div>
            <p>One quick and easy way to make cash in bug bounty job is subdomain takeover.
The goal is to steal a forgetted/unused subdomain of your target and put a PoC in place.
If you are able to do that, that means that instead of a plain text file, an attacker could replicate the true site of the victim and perform phishing.
This way he could trick users and even the employees of the company to grab useful data like credentials, this can also have really huge impact on the companies reputation.</p>
<p>First of all you have to find a list of subdomains of your target.
To perform that task, you can use a single tool like <a href="https://10degres.net/theharvester/">TheHarvester</a> or <a href="https://github.com/darkoperator/dnsrecon">DNSRecon</a>.</p>
<p>Then for each subdomains you should check if it is an alias or not, I personnally use the command <code>host</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>$ host rencontres.leparisien.fr
</span></span><span style="display:flex;"><span>rencontres.leparisien.fr is an alias for www.pointscommuns.com.
</span></span><span style="display:flex;"><span>www.pointscommuns.com has address 217.70.188.38
</span></span></code></pre></div><p>if yes, and if the alias destination is an external domain, then you should check his expiry date of this domain.
Because if this domain has expired, that means an attacker could buy it through a registrar like Gandi for a small amount.
Then put a fake look alike website in place and finally start social engineering by impersonating the vulnerable company.</p>
<p>To perform all those tests, I wrote a PHP script that takes a subdomains list as an argument.
Usage is:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>Usage: php dnsexpire.php [OPTIONS] -f &lt;subdomain|input file&gt;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Options:
</span></span><span style="display:flex;"><span>    -a  set alert for result output, default=30 days
</span></span><span style="display:flex;"><span>    -f  subdomains list source file
</span></span><span style="display:flex;"><span>    -h  print this help
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Examples:
</span></span><span style="display:flex;"><span>    php dnsexpire.php -f example.com
</span></span><span style="display:flex;"><span>    php dnsexpire.php -a 10 -f dns.txt
</span></span></code></pre></div><p>Output is:</p>
<p><img src="https://10degres.net/images/dnsexpire-example.jpg" alt="DNS expiration PHP tool"></p>
<p>The code is available on my <a href="https://github.com/gwen001/dnsexpire">GitHub repository</a> so give it a try!</p>
<h2 id="external-resources">External resources</h2>
<ul>
<li><a href="https://www.youtube.com/watch?v=aurAbCcF-lk">Explanation by Peter Yaworski</a></li>
</ul>
        </div>

        <footer>
            


        </footer>
    </article>

    
</section>

      </div>

      <footer class="footer">
  <section class="container">
    
    
    
    
  </section>
</footer>

    </main>

    
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-61485350-1', 'auto');
	
	ga('send', 'pageview');
}
</script>

    
      <script src="https://10degres.net/assets/js/scripts.js"></script>
    

  </body>

</html>
