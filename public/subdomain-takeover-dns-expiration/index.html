<!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <meta name="author" content="Gwendal Le Coguic">
    <meta name="description" content="Gwendal Le Coguic, web developer and bug hunter">
    <meta name="keywords" content="development,security,researcher,bugbounty,tools,php,python">

    <meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="http://10degres.net/assets/img/header-background.jpg"/>

<meta name="twitter:title" content="Subdomain takeover - DNS expiration"/>
<meta name="twitter:description" content="One quick and easy way to make cash in bug bounty job is subdomain takeover.
The goal is to steal a forgetted/unused subdomain of your target and put a PoC in place.
If you are able to do that, that means that instead of a plain text file, an attacker could replicate the true site of the victim and perform phishing.
This way he could trick users and even the employees of the company to grab useful data like credentials, this can also have really huge impact on the companies reputation.
First of all you have to find a list of subdomains of your target.
To perform that task, you can use a single tool like TheHarvester or DNSRecon."/>
<meta name="twitter:site" content="@10degres"/>
<meta name="twitter:creator" content="@gwendallecoguic"/>

    <meta property="og:title" content="Subdomain takeover - DNS expiration" />
<meta property="og:description" content="One quick and easy way to make cash in bug bounty job is subdomain takeover.
The goal is to steal a forgetted/unused subdomain of your target and put a PoC in place.
If you are able to do that, that means that instead of a plain text file, an attacker could replicate the true site of the victim and perform phishing.
This way he could trick users and even the employees of the company to grab useful data like credentials, this can also have really huge impact on the companies reputation.
First of all you have to find a list of subdomains of your target.
To perform that task, you can use a single tool like TheHarvester or DNSRecon." />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://10degres.net/subdomain-takeover-dns-expiration/" />

<meta property="og:image" content="http://10degres.net/assets/img/header-background.jpg" />
<meta property="article:published_time" content="2016-10-12T00:00:00+00:00" />
<meta property="article:modified_time" content="2016-10-12T00:00:00+00:00" /><meta property="og:site_name" content="10degres" />


    
      <base href="http://10degres.net/subdomain-takeover-dns-expiration/">
    
    <title>
  Subdomain takeover - DNS expiration · 10degres
</title>

    
      <link rel="canonical" href="http://10degres.net/subdomain-takeover-dns-expiration/">
    

    <link href="https://fonts.googleapis.com/css?family=Lato:400,700%7CMerriweather:300,700%7CSource+Code+Pro:400,700" rel="stylesheet">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.1/css/all.css" integrity="sha384-50oBUHEmvpQ+1lW4y57PTFmhCaXp0ML5d60M1M7uH2+nqUivzIebhndOJK28anvf" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.1/normalize.min.css" integrity="sha256-l85OmPOjvil/SOvVt3HnSSjzF1TUMyT9eV0c2BzEGzU=" crossorigin="anonymous" />

    
      
      
      <link rel="stylesheet" href="http://10degres.net/assets/css/coder.min.3d8325016df2bf0f0e874e28c83131f668a953cb3245cf9391fae4ff5b76b2ed.css" integrity="sha256-PYMlAW3yvw8Oh04oyDEx9mipU8syRc&#43;Tkfrk/1t2su0=" crossorigin="anonymous" media="screen" />
    

    

    

    
      <link rel="stylesheet" href="http://10degres.net/assets/css/custom.css" />
    

    <link rel="icon" type="image/png" href="http://10degres.net/assets/img/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="http://10degres.net/assets/img/favicon-16x16.png" sizes="16x16">

    <meta name="generator" content="Hugo 0.91.0" />
  </head>

  <body class=" ">
    <main class="wrapper">
      <nav class="navigation">
  <section class="container">
    <a class="navigation-title" href="http://10degres.net/">
      10degres
    </a>
    <input type="checkbox" id="menu-toggle" />
    <label class="menu-button float-right" for="menu-toggle"><i class="fas fa-bars">aaa</i></label>
    <ul class="navigation-list">
      
        
          <li class="navigation-item">
            <a class="navigation-link" href="http://10degres.net/posts/">Blog</a>
          </li>
        
          <li class="navigation-item">
            <a class="navigation-link" href="http://10degres.net/cves/">CVEs</a>
          </li>
        
          <li class="navigation-item">
            <a class="navigation-link" href="http://10degres.net/services/">Services</a>
          </li>
        
          <li class="navigation-item">
            <a class="navigation-link" href="http://10degres.net/press/">Press</a>
          </li>
        
          <li class="navigation-item">
            <a class="navigation-link" href="http://10degres.net/about/">About</a>
          </li>
        
      
      
    </ul>
  </section>
</nav>


      <div class="content">
        
  <section class="container post">
    <article>
      <header>
        <div class="post-title">
          <h1 class="title">Subdomain takeover - DNS expiration</h1>
        </div>
        <div class="post-meta">
          <div class="date">
            <span class="posted-on">
              <i class="fas fa-calendar"></i>
              <time datetime='2016-10-12T00:00:00Z'>
                October 12, 2016
              </time>
            </span>
            <span class="reading-time">
              <i class="fas fa-clock"></i>
              2 minutes read
            </span>
          </div>
          
          <div class="tags">
  <i class="fas fa-tag"></i>
    <a href="http://10degres.net/tags/dns/">dns</a>
      <span class="separator">•</span>
    <a href="http://10degres.net/tags/subdomain/">subdomain</a>
      <span class="separator">•</span>
    <a href="http://10degres.net/tags/tools/">tools</a></div>

        </div>
      </header>

      <div>
        <p>One quick and easy way to make cash in bug bounty job is subdomain takeover.
The goal is to steal a forgetted/unused subdomain of your target and put a PoC in place.
If you are able to do that, that means that instead of a plain text file, an attacker could replicate the true site of the victim and perform phishing.
This way he could trick users and even the employees of the company to grab useful data like credentials, this can also have really huge impact on the companies reputation.</p>
<p>First of all you have to find a list of subdomains of your target.
To perform that task, you can use a single tool like <a href="http://10degres.net/theharvester/">TheHarvester</a> or <a href="https://github.com/darkoperator/dnsrecon">DNSRecon</a>.</p>
<p>Then for each subdomains you should check if it is an alias or not, I personnally use the command <code>host</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">$ host rencontres.leparisien.fr
rencontres.leparisien.fr is an alias for www.pointscommuns.com.
www.pointscommuns.com has address 217.70.188.38
</code></pre></div><p>if yes, and if the alias destination is an external domain, then you should check his expiry date of this domain.
Because if this domain has expired, that means an attacker could buy it through a registrar like Gandi for a small amount.
Then put a fake look alike website in place and finally start social engineering by impersonating the vulnerable company.</p>
<p>To perform all those tests, I wrote a PHP script that takes a subdomains list as an argument.
Usage is:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">Usage: php dnsexpire.php [OPTIONS] -f &lt;subdomain|input file&gt;

Options:
    -a  set alert for result output, default=30 days
    -f  subdomains list source file
    -h  print this help

Examples:
    php dnsexpire.php -f example.com
    php dnsexpire.php -a 10 -f dns.txt
</code></pre></div><p>Output is:</p>
<p><img src="http://10degres.net/images/dnsexpire-example.jpg" alt="DNS expiration PHP tool"></p>
<p>The code is available on my <a href="https://github.com/gwen001/dnsexpire">GitHub repository</a> so give it a try!</p>
<h2 id="external-resources">External resources</h2>
<ul>
<li><a href="https://www.youtube.com/watch?v=aurAbCcF-lk">Explanation by Peter Yaworski</a></li>
</ul>
      </div>

      <footer>
        


      </footer>
    </article>

    
  </section>

      </div>

      <footer class="footer">
  <section class="container">
    
    
    
    
  </section>
</footer>

    </main>

    
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-61485350-1', 'auto');
	
	ga('send', 'pageview');
}
</script>

    
      <script src="http://10degres.net/assets/js/scripts.js"></script>
    
    
  </body>

</html>
