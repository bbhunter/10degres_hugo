---
cve: "CVE-2020-9998"
title: "Authenticated SQL injection in ZenphotoCMS v1.5.6 and prior"
date: 2020-02-12
draft: yes
tags:
- sql injection
---
Zenphoto v1.5.6 and prior is prone to SQL Injection. The parameter `order` in the function `postAlbumSort()` is not correctly sanitized.

- mitre: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-9998

<hr />

**Description:**  
The function `postAlbumSort()` triggers a SQL query using the POST parameter `order`, unfortunately his value is not sanitized when building the query.

**Environment:**  
Version: 1.5.6  
OS: Ubuntu 16.10  
Web server: Apache 2.4.18  
PHP: 7.4.2  
Database: MySQL 5.7.28  
URL: `/zp-core/admin-edit.php?page=edit&action=savealbumorder`  

**Payload:**  
```XSRFToken=bfc6ec5b3fdffce396ca60b824b68e3eb18a5d4c&checkallaction=noaction&newtag_mass_tags_=&massownerselect=admin&order=id%5B2 and (select sleep(5))%23%5D%3Dnull%26id%5B1%5D%3Dnull&update=Save+Order```

**Recommendation:**  
Cast the value to integer.

**PoC:**  
![cve-2020-2998](/images/cve-2020-2998.png)
